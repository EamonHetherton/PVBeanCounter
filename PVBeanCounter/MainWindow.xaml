<Window x:Class="PVBeanCounter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:col="clr-namespace:System.Collections;assembly=mscorlib"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:cgs="clr-namespace:CGS;assembly=TimeControl"
        xmlns:local="clr-namespace:PVBeanCounter"  
        Title="PV Bean Counter - Configuration" Height="643" Width="991" IsManipulationEnabled="True" ResizeMode="CanResize" UseLayoutRounding="True" WindowStyle="ThreeDBorderWindow" Loaded="Window_Loaded" Background="#FFDEFEFF">
    <Window.Resources>
        
        <Style TargetType="ToolTip">
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock TextWrapping="Wrap" MaxWidth="200" Text="{Binding}" />
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style TargetType="TabItem">
            <Setter Property="Template" >
                <Setter.Value>                    
                        <ControlTemplate TargetType="{x:Type TabItem}">
                            <Grid SnapsToDevicePixels="True">
                                <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1,1,1,0" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter x:Name="Content" ContentTemplate="{TemplateBinding HeaderTemplate}" Content="{TemplateBinding Header}" ContentStringFormat="{TemplateBinding HeaderStringFormat}" ContentSource="Header" HorizontalAlignment="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type ItemsControl}}}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{Binding VerticalContentAlignment, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type ItemsControl}}}"/>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" TargetName="Bd">
                                        <Setter.Value>
                                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                                <GradientStop Color="#FFEAF6FD" Offset="0.15"/>
                                                <GradientStop Color="#FFD9F0FC" Offset="0.5"/>
                                                <GradientStop Color="#FFBEFAFD" Offset="0.5"/>
                                                <GradientStop Color="#FF9BE0F0" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" TargetName="Bd">
                                        <Setter.Value>
                                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                                <GradientStop Color="#FFD8F7FB" Offset="0"/>
                                                <GradientStop Color="#FFF5F3F3" Offset="0.5"/>
                                                <GradientStop Color="#FFE7FEFF" Offset="0.5"/>
                                                <GradientStop Color="#FF9CB5DA" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsSelected" Value="False" >
                                <Setter Property="Background" TargetName="Bd">
                                        <Setter.Value>
                                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                                <GradientStop Color="#FFC0E9EE" Offset="0"/>
                                                <GradientStop Color="#FFEBEBEB" Offset="0.5"/>
                                                <GradientStop Color="#FFDEFEFF" Offset="0.5"/>
                                                <GradientStop Color="#FF88A3CB" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>

                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="False"/>
                                        <Condition Property="IsMouseOver" Value="True"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="BorderBrush" TargetName="Bd" Value="#FF3C7FB1"/>
                                </MultiTrigger>
                                <Trigger Property="TabStripPlacement" Value="Bottom">
                                    <Setter Property="BorderThickness" TargetName="Bd" Value="1,0,1,1"/>
                                </Trigger>
                                <Trigger Property="TabStripPlacement" Value="Left">
                                    <Setter Property="BorderThickness" TargetName="Bd" Value="1,1,0,1"/>
                                </Trigger>
                                <Trigger Property="TabStripPlacement" Value="Right">
                                    <Setter Property="BorderThickness" TargetName="Bd" Value="0,1,1,1"/>
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="True"/>
                                        <Condition Property="TabStripPlacement" Value="Top"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Margin" Value="-2,-2,-2,-1"/>
                                    <Setter Property="Margin" TargetName="Content" Value="0,0,0,1"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="True"/>
                                        <Condition Property="TabStripPlacement" Value="Bottom"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Margin" Value="-2,-1,-2,-2"/>
                                    <Setter Property="Margin" TargetName="Content" Value="0,1,0,0"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="True"/>
                                        <Condition Property="TabStripPlacement" Value="Left"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Margin" Value="-2,-2,-1,-2"/>
                                    <Setter Property="Margin" TargetName="Content" Value="0,0,1,0"/>
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="True"/>
                                        <Condition Property="TabStripPlacement" Value="Right"/>
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Margin" Value="-1,-2,-2,-2"/>
                                    <Setter Property="Margin" TargetName="Content" Value="1,0,0,0"/>
                                </MultiTrigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Background" TargetName="Bd" Value="#FFF4F4F4"/>
                                    <Setter Property="BorderBrush" TargetName="Bd" Value="#FFC9C7BA"/>
                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                </Setter.Value>                
            </Setter>
            
        </Style>

        <local:NullableValueConverter x:Key="NullableValueConverter" />
  
    </Window.Resources>
  
    <Grid Name="gridPVSettings" DataContext="{Binding}" Margin="2,2,2,2" Background="#00000000">
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition MaxHeight="40" />
        </Grid.RowDefinitions>
        <TabControl Height="Auto" Name="tabControl1" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" 
                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="2" Background="{x:Null}">

            <TabItem Header="General" Name="tabItem4" ToolTip="Perform basic setup steps. Always start here." Padding="6,3" >

                <Grid Margin="0,10,10,0">
                    <Grid.RowDefinitions>
                        <RowDefinition MaxHeight="35" Height="35" />
                        <RowDefinition MaxHeight="35" Height="35" />
                        <RowDefinition MaxHeight="35" Height="35" />
                        <RowDefinition MaxHeight="35" Height="35" />
                        <RowDefinition MaxHeight="25" Height="25" />
                        <RowDefinition MaxHeight="25" Height="25" />
                        <RowDefinition MaxHeight="45" Height="38" />
                        <RowDefinition MaxHeight="25" Height="25" />
                        <RowDefinition Height="43" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="190" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Label Content="Database Type" Height="28" HorizontalAlignment="Right" Name="label39" VerticalAlignment="Center" HorizontalContentAlignment="Right" />
                    <ComboBox Height="23" Name="comboBoxStandardDB" Text="{Binding Path=StandardDBType, Converter={StaticResource NullableValueConverter}}" Width="95" Grid.Column="1" VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left">
                        <ComboBoxItem Content="Custom" />
                        <ComboBoxItem Content="Jet (2003)" />
                        <ComboBoxItem Content="Jet (2007)" />
                        <ComboBoxItem Content="MySQL" />
                        <ComboBoxItem Content="SQLite" />
                        <ComboBoxItem Content="SQL Server" />
                    </ComboBox>

                    <Label Content="Default Directory" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label12" Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Right" />
                    <Grid VerticalAlignment="Center" HorizontalAlignment="Stretch" Grid.Column="1" Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition MaxWidth="30" />
                        </Grid.ColumnDefinitions>
                        <TextBox Name="textBox1" Text="{Binding Path=DefaultDirectory, Converter={StaticResource NullableValueConverter}}" ToolTip="The directory name used to store files downloaded from the inverter and any other files required by the inverter manager software" VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" />
                        <Button Content="..." Height="23" Name="butDefaultDirectory" Click="butDefaultDirectory_Click" Width="26" HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="1" Grid.RowSpan="1" Grid.Row="0" />
                    </Grid>
                    <Label Content="First Full Day" DataContext="{Binding}" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label15" HorizontalAlignment="Right" Grid.Row="2" VerticalContentAlignment="Center" VerticalAlignment="Center" />
                    <DatePicker Name="datePicker1" SelectedDate="{Binding Path=FirstFullDay, Converter={StaticResource NullableValueConverter}}" ToolTip="Normally set to the day after installation. This prevents constant attempts to retrieve the the incomplete data set from the activation day. Default value for all Inverter Managers." Width="125" Grid.Column="1" Grid.Row="2" VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left" HorizontalContentAlignment="Stretch"  />
                    
                    <CheckBox Content="Emit Events (use with PVMonitor)" Height="16" HorizontalAlignment="Left" IsChecked="{Binding Path=EmitEvents}" 
                              ToolTip="Check to emit events for use with PVMonitor" VerticalAlignment="Center" 
                              Grid.Column="1" Grid.Row="3" VerticalContentAlignment="Center" />

                    <Grid Grid.Column="1" Grid.Row="6">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <ComboBox Grid.Column="0" Grid.Row="6" HorizontalAlignment="Left" Text="{Binding Path=ServiceAccountName, Converter={StaticResource NullableValueConverter}}"  Name="comboBoxServiceAccount" VerticalAlignment="Center" Width="155" IsEditable="True" VerticalContentAlignment="Center" Margin="0,6" SelectionChanged="comboBoxServiceAccount_SelectionChanged" ToolTip="Sets the windows &quot;Account&quot; used to run the PVBC Service. Normally &quot;Local Service&quot;. Change this if the PVBC Service cannot access Bluetooth communications or if the PVBC data files are held in a restricted access location.">
                            <ComboBoxItem Content="Local Service" />
                            <ComboBoxItem Content="Network Service" />
                            <ComboBoxItem Content="Local System" />
                        </ComboBox>
                        <PasswordBox HorizontalAlignment="Left" Name="passwordBoxServiceAccount" Width="120" Grid.Column="2" VerticalAlignment="Center" VerticalContentAlignment="Center" PasswordChanged="passwordBoxServiceAccount_PasswordChanged" ToolTip="Password for the &quot;Service Account&quot;. Not required for &quot;Local Service&quot;, &quot;Network Service&quot; or &quot;Local System&quot;." />
                        <Label Content="Password" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Margin="20,6,4,6" Name="label35" VerticalAlignment="Center" VerticalContentAlignment="Center" Grid.Column="1" />
                        <CheckBox Content="Password Required" Grid.Column="2" IsChecked="{Binding Path=ServiceAccountRequiresPassword, Converter={StaticResource NullableValueConverter}}" HorizontalAlignment="Left" Margin="126,11,0,0" Name="checkBoxServiceRequiresPassword" VerticalAlignment="Top" Click="checkBoxServiceRequiresPassword_Click" ToolTip="Check if you need to change tha password associated with the Service Account." />
                    </Grid>

                    <CheckBox Content="AutoStart PVBC Service" Height="16" HorizontalAlignment="Left" IsChecked="{Binding Path=AutoStartPVBCService}" Name="checkBoxAutoStartService" ToolTip="Check to enable automatic startup of PVBC service (Check for normal operation)" VerticalAlignment="Center" Grid.Column="1" Grid.Row="7" VerticalContentAlignment="Center" />

                    <Button Content="Setup / Check Environment" Height="23" HorizontalAlignment="Left" Name="butCheckEnv" Click="butCheckEnv_Click" VerticalAlignment="Center" ToolTip="Click to perform initial environment setup or to check environment settings" Grid.Row="8" Padding="4,0,3,4" Margin="0,0,0,0" Grid.Column="1" />
                    <Label Content="Service Account" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Name="label34" VerticalAlignment="Center" VerticalContentAlignment="Center" Grid.Row="6" />
                </Grid>
            </TabItem>

            <TabItem Header="Device Managers" Name="tabItemDevMgrs" ToolTip="Configure Device Managers - Define devices to be monitored" Padding="6,3" IsSelected="True" >
                <Grid ToolTip="Configure Device Managers and associated Devices" >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"  />
                        <ColumnDefinition />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <Grid Grid.Row="0" Margin="10,10,0,0" Background="#FFFAFFCA">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Label Content="Device Managers" Margin="10,0,0,0" FontWeight="Bold" FontSize="13"/>
                            <DataGrid Grid.Row="1" AutoGenerateColumns="False" MinWidth="210"  DataContext="{Binding}" HorizontalAlignment="Stretch" ItemsSource="{Binding DeviceManagerList}" Name="dataGridDeviceManagers" VerticalAlignment="Stretch" GridLinesVisibility="Horizontal" SelectedIndex="0" ToolTip="Select a Device Manager for detail display. Enable and disable individual Modbus Managers." SelectionChanged="dataGridDeviceManagers_SelectionChanged" Margin="10,0,10,0" Background="#FFFAFFCA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Description" MinWidth="140" IsReadOnly="True" Binding="{Binding Description}"/>
                                    <DataGridCheckBoxColumn Binding="{Binding Path=Enabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Enabled" >
                                        <DataGridCheckBoxColumn.EditingElementStyle>
                                            <Style TargetType="CheckBox">
                                                <Setter Property="IsEnabled"  Value="{Binding Path=IsRealDeviceManager}" />
                                                <Setter Property="HorizontalAlignment"  Value="Center" />
                                            </Style>
                                        </DataGridCheckBoxColumn.EditingElementStyle>
                                        <DataGridCheckBoxColumn.ElementStyle>
                                            <Style TargetType="CheckBox">
                                                <Setter Property="IsEnabled"  Value="{Binding Path=IsRealDeviceManager}" />
                                                <Setter Property="HorizontalAlignment"  Value="Center" />
                                            </Style>
                                        </DataGridCheckBoxColumn.ElementStyle>
                                    </DataGridCheckBoxColumn> 
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Margin="0,10,0,0" Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Button Content="Add Manager" Height="23" HorizontalAlignment="Left" Name="buttonAddDeviceMgr" VerticalAlignment="Top" Click="buttonAddModbusMgr_Click" ToolTip="Add a new Device Manager" Margin="10,0,2,10" Padding="2,1" />
                                <Button Content="Delete Manager" Height="23" HorizontalAlignment="Right" Name="buttonDeleteDeviceMgr" VerticalAlignment="Top" Click="buttonDeleteModbusMgr_Click" Grid.Column="1" ToolTip="Delete the selected Device Manager" Margin="2,0,10,10" Padding="2,1" IsEnabled="False" />
                            </Grid>
                        </Grid>
                    </Grid>
                    
                    <Grid Margin="0,10" Column="1" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid Name="gridDeviceManagers" Margin="0" Row="0"  Background="#FFFAFFCA" >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <Label Content="Device Manager Configuration" FontWeight="Bold" FontSize="13" />
                            <Grid Margin="0,0,10,5" Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />                                    
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Label Content="Manager Name" HorizontalContentAlignment="Right" VerticalAlignment="Center" VerticalContentAlignment="Center" FontSize="11" Padding="0,5,5,5" />
                                <TextBox Grid.Column="1" Text="{Binding Path=Name, Converter={StaticResource NullableValueConverter}}" VerticalAlignment="Center" VerticalContentAlignment="Center" FontSize="11" />
                                <Label Content="Manager Type" Grid.Row="1" HorizontalContentAlignment="Right" VerticalAlignment="Center" VerticalContentAlignment="Center" FontSize="11" Margin="5,0,2,0" />
                                <ComboBox Grid.Row="1" Grid.Column="1" Height="23" HorizontalAlignment="Stretch" Margin="0,3,0,0" Name="comboBoxProtocol" VerticalAlignment="Top" SelectedValuePath="Name" Text="{Binding Path=Protocol, Converter={StaticResource NullableValueConverter}}" DisplayMemberPath="Name" SelectionChanged="comboBoxProtocol_SelectionChanged" ToolTip="Selects the device access method (protocol)" FontSize="11" LostFocus="comboBoxProtocol_LostFocus"  />
                                <Grid Grid.Row="2" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" MinWidth="60"/>
                                        <ColumnDefinition Width="Auto" MinWidth="70"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Name="checkBoxDevMgrEnabled" Content="Enabled" IsChecked="{Binding Path=Enabled, Converter={StaticResource NullableValueConverter}}"  Margin="0,5,0,0" FontWeight="Bold" />
                                    <Grid Name="gridSerialBasic" Grid.Column="1" Visibility="Visible" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" MinWidth="60"/>
                                            <ColumnDefinition Width="Auto" MinWidth="70"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Content="Port" IsEnabled="True" Padding="20,5,5,2" FontSize="11" HorizontalAlignment="Right" />
                                        <ComboBox Name="comboBoxMMPortName" Grid.Column="1"  Height="18" MinWidth="50" Text="{Binding Path=PortName, Converter={StaticResource NullableValueConverter}}" ToolTip="Serial port port name - e.g. COM3" VerticalAlignment="Bottom" VerticalContentAlignment="Center" Margin="0,0,3,0" FontSize="9" />
                                        <Label Content="Baud Rate" IsEnabled="True" Grid.Column="2" Padding="5,5,5,2" FontSize="11" HorizontalAlignment="Right" />
                                        <ComboBox Name="comboBoxMMBaudRate" Height="17"  Grid.Column="3"  MinWidth="70"  Text="{Binding Path=BaudRate, Converter={StaticResource NullableValueConverter}}" IsEditable="True" ToolTip="Serial port baud rate (transmission speed)" VerticalAlignment="Bottom" VerticalContentAlignment="Center" Margin="0,0,3,0" FontSize="9" />
                                    </Grid>
                                </Grid>
                            </Grid>
                            
                            <Expander Name="expanderDeviceMgrAdvanced" Grid.Row="2" Header="Advanced Settings" Margin="0,0,0,7" Expanded="expanderDeviceMgrAdvanced_Expanded" FontSize="11">
                                <StackPanel >
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <Grid Name="gridSerialDetail" Visibility="Visible" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="85,0,10,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />                                               
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>

                                                <Label Content="Parity" IsEnabled="True" Padding="0,5,5,2" FontSize="10.5" VerticalAlignment="Top" />
                                                <ComboBox Name="comboBoxMMParity" MinWidth="45" Height="18" Text="{Binding Path=Parity, Converter={StaticResource NullableValueConverter}}" ToolTip="Serial port parity (simple error check type)" Grid.Row="1" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,0,8,0" FontSize="9" />

                                                <Label Content="Data Bits" IsEnabled="True" Grid.Column="1" Padding="0,5,5,2" FontSize="10.5" />
                                                <ComboBox Name="comboBoxMMDataBits" MinWidth="35" Height="18" Text="{Binding Path=DataBits, Converter={StaticResource NullableValueConverter}}" ToolTip="Serial port data bits (almost always set to 8)" Grid.Column="1" Grid.Row="1" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,0,8,0" FontSize="9" />

                                                <Label Content="Stop Bits" IsEnabled="True" Grid.Column="2" Padding="0,5,5,2" FontSize="10.5" HorizontalAlignment="Left" />
                                                <ComboBox Name="comboBoxMMStopBits" Height="18" Text="{Binding Path=StopBits, Converter={StaticResource NullableValueConverter}}" ToolTip="Serial port stop bits - (almost always set to One)" Grid.Column="2" Grid.Row="1" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,0,8,0" FontSize="9" />

                                                <Label Content="Handshake" IsEnabled="True" Grid.Column="3" Padding="5,5,5,2" FontSize="10.5" />
                                                <ComboBox Name="comboBoxMMHandshake" MinWidth="70" Height="18" Text="{Binding Path=Handshake, Converter={StaticResource NullableValueConverter}}" ToolTip="Serial port handshake (XOn / XOff, Hardware, None)" Grid.Column="3" Grid.Row="1" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,0,0,0" FontSize="9" />
                                            </Grid>
                                            <Grid Name="gridHistoryHours" Grid.Column="1">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Label Content="History Hours" Padding="0,5,5,2" FontSize="10.5" VerticalAlignment="Top" />
                                                <TextBox Grid.Row="1" Height="18" MinWidth="70" HorizontalAlignment="Left" Text="{Binding Path=HistoryHours, Converter={StaticResource NullableValueConverter}}" VerticalAlignment="Center" ToolTip="Enter the number of hours in the past that will be adjusted by history record content" />
                                            </Grid>
                                            <Grid Name="gridHistoryDays" Grid.Column="0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                            </Grid>
                                        </Grid>
                                        
                                        <Grid Grid.Row="1" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            
                                            <Grid Name="gridListenerDevice" Margin="85,0,0,0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Label Content="Listener Device" VerticalAlignment="Center" HorizontalAlignment="Left" FontSize="10.5" VerticalContentAlignment="Center" Padding="0,5,5,2"  />
                                                <ComboBox Name="comboBoxListenerDevice" Grid.Row="1" Height="18" HorizontalAlignment="Left" Margin="0,0,8,0" 
                                                          ItemsSource="{Binding Path=DeviceListItems, NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True}" VerticalAlignment="Top" 
                                                          MinWidth="290" Text="{Binding Path=ListenerDeviceId, Converter={StaticResource NullableValueConverter}}" SelectedValuePath="Id" 
                                                          DisplayMemberPath="Description" FontSize="9" />
                                            </Grid>
                                            <Grid Name="gridDeviceManagerTimings" Grid.Column="1">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" Name="columnDeviceAdvancedTiming_Qry" />
                                                    <ColumnDefinition Width="Auto" Name="columnDeviceAdvancedTiming_DB" />
                                                </Grid.ColumnDefinitions>
                                                <Label Content="Query Int" Grid.Column="0" Margin="-5,0,0,0"  VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left"  FontSize="10.5" Padding="0,5,5,2" />
                                                <Label Content="DB Int" Grid.Column="1" Margin="-5,0,0,0"   VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left"  FontSize="10.5" Padding="5,5,5,2" />
                                                <ComboBox Grid.Row="1" Grid.Column="0" Height="18" HorizontalAlignment="Left" Margin="0,0,0,0" Name="comboBoxMessageInterval" VerticalAlignment="Top" Width="40" Text="{Binding Path=MessageInterval, Converter={StaticResource NullableValueConverter}}" FontSize="9" />
                                                <ComboBox Grid.Row="1" Grid.Column="1" Height="18" HorizontalAlignment="Left" Margin="0,0,0,0" Name="comboBoxDBInterval" VerticalAlignment="Top" Width="40" Text="{Binding Path=DBInterval, Converter={StaticResource NullableValueConverter}}" FontSize="9" />
                                            </Grid>
                                        </Grid>
                                        <Grid Name="gridExecutablePath" Grid.Row="2">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Label Content="Executable Path" Grid.Column="0"  VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left"  FontSize="10.5" />
                                            <TextBox Grid.Column="1" Height="18" Text="{Binding Path=ExecutablePath, Converter={StaticResource NullableValueConverter}}"  Margin="0,0,10,0" FontSize="10.5" />
                                            <Button Content="..." Name="butExecutable" Click="butExecutable_Click" Grid.Column="2" Padding="8,0" VerticalAlignment="Center" MinHeight="18" Margin="0,0,10,0" />
                                        </Grid>
                                        <Grid Name="gridSunnyExplorerAdvanced" Grid.Row="3">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="35" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="60" />
                                            </Grid.ColumnDefinitions>
                                            <Label Content="Plant Name" Margin="18,0,0,0" Grid.Column="0" HorizontalContentAlignment="Right" VerticalAlignment="Center" VerticalContentAlignment="Center" FontSize="10.5" />
                                            <TextBox Name="textBoxSunnyExplorerPlantName" Grid.Column="1" Text="{Binding Path=SunnyExplorerPlantName}" ToolTip="The &quot;Plant Name&quot; recorded in the &quot;SunnyExplorer.sx2&quot; file" VerticalAlignment="Center" VerticalContentAlignment="Center" FontSize="10.5" Margin="0,4,4,4" />
                                            <Label Grid.Column="2" Content="Hist Days" Padding="8,0,5,0" VerticalAlignment="Center" FontSize="10.5" />
                                            <TextBox Grid.Column="3" Height="18" MinWidth="70" HorizontalAlignment="Left" Text="{Binding Path=MaxSMAHistoryDays}" VerticalAlignment="Center" ToolTip="Enter the number of days history stored in the device" />
                                            <Label Content="Password" Height="28" HorizontalContentAlignment="Right" Grid.Column="4" Padding="8,0,5,0" VerticalAlignment="Center" VerticalContentAlignment="Center" />
                                            <TextBox Name="textBoxSunnyExplorerPassword" Text="{Binding Path=SunnyExplorerPassword}" ToolTip="The inverter password (default is '0000')" Grid.Column="5" MinWidth="60" Margin="0,0,10,0" VerticalAlignment="Center" VerticalContentAlignment="Center" FontSize="10.5" />
                                        </Grid>
                                    </Grid>
                                    <Grid Name="gridDeviceDatabase">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition  Width="Auto"/>
                                            <ColumnDefinition />
                                            <ColumnDefinition  Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Name="labelDeviceDB" Content="Device DB" HorizontalContentAlignment="Right" HorizontalAlignment="Right" FontSize="10.5" Margin="25,0,0,0" />
                                        <TextBox Grid.Row="0" Name="textBoxDeviceDB" Grid.Column="1"  Text="{Binding Path=DeviceDatabase, Converter={StaticResource NullableValueConverter}}" VerticalContentAlignment="Center" VerticalAlignment="Center" MinWidth="200" HorizontalAlignment="Left" FontSize="9" />
                                        <Button Grid.Row="0" Grid.Column="2" Content="..." Height="18" Name="butBrowseOwlDb" ToolTip="Browse for the Owl database file" Width="24" Click="butBrowseOwlDb_Click" FontSize="9" Margin="5,0,10,0" />
                                        <CheckBox Grid.Row="0" Grid.Column="3" Content="Reload" IsChecked="{Binding Path=ReloadDays, Converter={StaticResource NullableValueConverter}}" Height="16" Name="checkBoxOwlReload" Click="checkBoxOwlReload_Click" ToolTip="Check to force a reload of data from the Owl database starting at the specified date" />
                                        <DatePicker Grid.Row="0" Grid.Column="4" Height="24" SelectedDate="{Binding Path=ReloadDaysFromDate, Converter={StaticResource NullableValueConverter}}" Margin="10,0,10,0" Name="datePickerOwlReload" FontSize="9" ToolTip="The date at which an Owl meter data reload starts" HorizontalContentAlignment="Stretch"  />
                                    </Grid>
                                </StackPanel>
                            </Expander>
                        </Grid>
                        <Grid Name="gridDevice" Row="1"  Background="#FFDAFFBB" Margin="0,0,0,-8" >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"  />
                                <RowDefinition Height="Auto"  />
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" Name="rowPVOutput"/>
                                <RowDefinition Height="Auto" Name="rowAddressSerialNo"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Label Content="Device Configuration" Grid.ColumnSpan="2" Padding="8,4,0,4" FontSize="13" FontWeight="Bold"/>
                            <Label Content="Name" Grid.Row="1" HorizontalAlignment="Right" HorizontalContentAlignment="Right" />
                            <TextBox Text="{Binding Path=Name, Converter={StaticResource NullableValueConverter}}" Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" FontSize="11" VerticalAlignment="Center" VerticalContentAlignment="Center"  />
                            <Label Content="Device Type" Grid.Row="2" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Margin="0,3" />
                            <Grid Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <ComboBox Name="comboBoxDeviceType" SelectedValue="{Binding Path=Id, NotifyOnSourceUpdated=True ,Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" SelectedValuePath="Id" DisplayMemberPath="Description" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5,0,5" SourceUpdated="comboBoxDeviceType_SourceUpdated" />
                                <Grid Name="gridConsolidationType" Grid.Column="1" >
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Label Content="Consolidation Type" HorizontalAlignment="Right" HorizontalContentAlignment="Right" Margin="0,3" />
                                    <ComboBox Name="comboBoxConsolidationType" ItemsSource="{Binding AllConsolidationTypes}" Grid.Column="1" SelectedValue="{Binding Path=ConsolidationType, NotifyOnSourceUpdated=True ,Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5,0,5" SourceUpdated="comboBoxConsolidationType_SourceUpdated" />
                                </Grid>
                            </Grid>
                            <Label Grid.Row="3" Grid.Column="0" Name="labelPVOutputSystem" Content="System" HorizontalAlignment="Right" />
                            <ComboBox Name="comboBoxPVOutputSystem" Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3" Margin="0,5,0,5" ItemsSource="{Binding PVOutputSystemList}" SelectedValue="{Binding Path=PVOutputSystem}" SelectedValuePath="SystemId" DisplayMemberPath="Description" ToolTip="Select the PVOutput System ID that consumes readings from this device" />
                            
                            <Label Name="labelDeviceAddress" Content="Address" Grid.Row="4" HorizontalContentAlignment="Right" HorizontalAlignment="Right"/>
                            <TextBox Name="textBoxDeviceAddress" Text="{Binding Path=Address, Converter={StaticResource NullableValueConverter}}" Grid.Row="4" Grid.Column="1" 
                                     VerticalContentAlignment="Center" VerticalAlignment="Center" MinWidth="40" HorizontalAlignment="Left" FontSize="9" />
                            <Label Name="labelSerialNo" Content="Serial No." Grid.Column="2" Grid.Row="4" HorizontalContentAlignment="Right" HorizontalAlignment="Right" Margin="20,0,0,0"/>
                            <TextBox Name="textBoxSerialNo" Text="{Binding Path=SerialNo, Converter={StaticResource NullableValueConverter}}" 
                                     Grid.Row="4" Grid.Column="3" VerticalContentAlignment="Center" VerticalAlignment="Center" FontSize="9" />
                            
                            <Expander Name="expanderDeviceAdvanced" Header="Advanced Settings" Grid.Row="5" Grid.ColumnSpan="4" Expanded="expanderDeviceAdvanced_Expanded" FontSize="11">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition  Width="Auto"/>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Name="rowDeviceAdvanced_0" />
                                            <RowDefinition Name="rowDeviceAdvanced_1" />
                                            <RowDefinition Name="rowDeviceAdvanced_2" />
                                            <RowDefinition Name="rowDeviceAdvanced_3" />
                                            <RowDefinition Name="rowDeviceAdvanced_4" />
                                        </Grid.RowDefinitions>
                                        <Label Content="Make" HorizontalAlignment="Right" FontSize="10.5"/>
                                        <TextBox Text="{Binding Path=Manufacturer, Converter={StaticResource NullableValueConverter}}" Grid.Column="1" VerticalContentAlignment="Center" VerticalAlignment="Center" FontSize="9" />
                                        <Label Content="Model" Grid.Column="2" HorizontalContentAlignment="Right" HorizontalAlignment="Right" Margin="20,0,0,0" FontSize="10.5"/>
                                        <TextBox Text="{Binding Path=Model, Converter={StaticResource NullableValueConverter}}" Grid.Column="3" VerticalContentAlignment="Center" VerticalAlignment="Center" FontSize="9"  />
                                        
                                        <Label Name="labelDeviceQueryInterval" Content="QueryInterval" Grid.Row="1" HorizontalContentAlignment="Right" HorizontalAlignment="Right" FontSize="10.5" />                                                                           
                                        <ComboBox Grid.Row="1"  Grid.Column="1" Height="Auto" HorizontalAlignment="Left" Margin="0,3,10,3" Name="comboBoxDeviceQueryInterval" VerticalAlignment="Center" Width="45" Text="{Binding Path=QueryInterval, Converter={StaticResource NullableValueConverter}}" FontSize="9" VerticalContentAlignment="Center" />

                                        <Label Grid.Row="1" Grid.Column="2" Content="DB Interval" HorizontalContentAlignment="Right" HorizontalAlignment="Right" FontSize="10.5" />
                                        <ComboBox Grid.Row="1" Grid.Column="3" Height="Auto" HorizontalAlignment="Left" Margin="0,3,10,3" 
                                                  Name="comboBoxDeviceDBInterval" VerticalAlignment="Center" Width="45" Text="{Binding Path=DBInterval, Converter={StaticResource NullableValueConverter}}" FontSize="9" VerticalContentAlignment="Center" />
                                        <Label Name="labelCalibrate" Grid.Row="2" Content="Calibrate" HorizontalContentAlignment="Right" HorizontalAlignment="Right" FontSize="10.5" />
                                        <TextBox Name="textBoxCalibrate" Grid.Row="2" Grid.Column="1" Text="{Binding Path=CalibrationFactor, Converter={StaticResource NullableValueConverter}}" VerticalContentAlignment="Center" VerticalAlignment="Center" MinWidth="50" FontSize="9" MaxWidth="70" HorizontalAlignment="Left" />
                                        <Label Name="labelThreshold" Grid.Row="2" Grid.Column="2" Content="Threshold" HorizontalContentAlignment="Right" HorizontalAlignment="Right" FontSize="10.5" />
                                        <StackPanel Name="stackPanelThreshold" Grid.Row="2" Grid.Column="3" Orientation="Horizontal">
                                            <TextBox Text="{Binding Path=ZeroThreshold, Converter={StaticResource NullableValueConverter}}" VerticalContentAlignment="Center" VerticalAlignment="Center" MinWidth="50" FontSize="9" MaxWidth="70" HorizontalAlignment="Left" />
                                            <Label Grid.Row="2" Grid.Column="2" Content="(zero watts)" HorizontalContentAlignment="Right" HorizontalAlignment="Left" FontSize="10.5" />
                                        </StackPanel>
                                        <CheckBox Content="History Adjust" Grid.Row="3" Grid.Column="1" Name="checkBoxHistoryAdjust"
                                                  IsChecked="{Binding Path=UpdateHistory, Converter={StaticResource NullableValueConverter}}" 
                                                  HorizontalAlignment="Left" VerticalContentAlignment="Center" VerticalAlignment="Center" Padding="4,0,0,0" Margin="0,2" FontSize="10.5" />

                                    </Grid>

                                </StackPanel>
                            </Expander>
                            <Grid Name="gridConsolidations" Grid.Row="6" Background="#FFDAFFBB" Grid.ColumnSpan="4"  Margin="0,0,0,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>

                                    <Expander Name="expanderConsolidatesTo" Header="Consolidates To"   Margin="0,0,0,0" Expanded="expanderConsolidatesTo_Expanded"  >
                                        <Grid Margin="5,0,0,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <DataGrid Name="datGridConsolidateToDevices" ItemsSource="{Binding Path=ConsolidateToDevices}" Margin="0,5,0,0" 
                                                      AutoGenerateColumns="False" MinHeight="22" ColumnHeaderHeight="20" SelectionMode="Single" FontSize="10" 
                                                      CanUserDeleteRows="False" CanUserAddRows="False" ColumnWidth="Auto" SelectionChanged="datGridConsolidateToDevices_SelectionChanged" 
                                                      ToolTip="List of Device Feature consolidations sourced from the selected Device">
                                                <DataGrid.Columns>
                                                    <DataGridComboBoxColumn x:Name="consolidateToDeviceColumn" Header="Device" DisplayMemberPath="Name"  Width="Auto" MinWidth="100" SelectedItemBinding="{Binding ConsolidateToDevice, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="False" />
                                                    <DataGridComboBoxColumn x:Name="consolidateToFeatureColumn" Header="To Feature" DisplayMemberPath="Name" Width="Auto" MinWidth="75" SelectedItemBinding="{Binding ConsolidateToFeature, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource NullableValueConverter}}" CanUserResize="False">
                                                        <DataGridComboBoxColumn.EditingElementStyle>
                                                            <Style TargetType="ComboBox">                                                   
                                                                <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateToFeatures}" />
                                                            </Style>
                                                        </DataGridComboBoxColumn.EditingElementStyle>
                                                        <DataGridComboBoxColumn.ElementStyle>
                                                            <Style TargetType="ComboBox">
                                                                <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateToFeatures}" />
                                                            </Style>
                                                        </DataGridComboBoxColumn.ElementStyle>
                                                    </DataGridComboBoxColumn>
                                                    <DataGridComboBoxColumn x:Name="consolidateFromFeatureColumn" Header="From Feature" DisplayMemberPath="Name" Width="Auto" MinWidth="75" 
                                                         SelectedItemBinding="{Binding ConsolidateFromFeature, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource NullableValueConverter}}" CanUserResize="False">
                                                        <DataGridComboBoxColumn.EditingElementStyle>
                                                            <Style TargetType="ComboBox">
                                                                <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateFromFeatures}" />
                                                            </Style>
                                                        </DataGridComboBoxColumn.EditingElementStyle>
                                                        <DataGridComboBoxColumn.ElementStyle>
                                                            <Style TargetType="ComboBox">
                                                                <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateFromFeatures}" />
                                                            </Style>
                                                        </DataGridComboBoxColumn.ElementStyle>
                                                    </DataGridComboBoxColumn>
                                                    <DataGridTextColumn Binding="{Binding Operation}" Header="Operation" IsReadOnly="True" CanUserResize="False" />
                                                    <DataGridCheckBoxColumn Header="Use Temp" Binding="{Binding Path=UseTemperature, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </DataGrid.Columns>
                                            </DataGrid>
                                            <Grid Margin="0,7,0,0" Grid.Row="1">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <Button Content="Add" Height="23" HorizontalAlignment="Left" Name="buttonAddConsolidateTo"  VerticalAlignment="Top" ToolTip="Identify a Feature of a consolidation device that consolidates a specific feature of the selected Device" Margin="0,0,2,0" Padding="5,0" Click="buttonAddConsolidateTo_Click" FontSize="10" />
                                                <Button Content="Delete" Height="23" HorizontalAlignment="Right" Name="buttonDeleteConsolidateTo" VerticalAlignment="Top" Grid.Column="1" ToolTip="Delete the selected Consolidation" Margin="2,0,5,4" Padding="5,0" IsEnabled="False" FontSize="10" Click="buttonDeleteConsolidateTo_Click" />
                                            </Grid>
                                        </Grid>
                                    </Expander>

                                    <Grid Name="gridConsolidatedFrom"   Grid.Row="1" Margin="0,0,0,0" >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="63*"/>
                                            <ColumnDefinition Width="152*"/>
                                        </Grid.ColumnDefinitions>
                                        <Expander Name="expanderConsolidatedFrom" Header="Consolidated From" Grid.Row="1" Grid.ColumnSpan="4" Expanded="expanderConsolidatedFrom_Expanded"  >
                                            <Grid Margin="5,0,0,0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <DataGrid ItemsSource="{Binding Path=ConsolidateFromDevices}" Margin="0,5,5,10" AutoGenerateColumns="False" MinHeight="22" 
                                                          ColumnHeaderHeight="20" SelectionMode="Single" FontSize="10"
                                                          ToolTip="List of Device Features that consolidate to the selected Device">
                                                    <DataGrid.Columns>
                                                        <DataGridComboBoxColumn x:Name="consolidateFromDeviceColumn" Header="Device" DisplayMemberPath="Name"  Width="Auto" MinWidth="100" SelectedItemBinding="{Binding ConsolidateFromDevice, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="False" IsReadOnly="True" />
                                                        <DataGridComboBoxColumn  DisplayMemberPath="Name" Header="From Feature"  Width="Auto" MinWidth="75" SelectedItemBinding="{Binding ConsolidateFromFeature, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="False" IsReadOnly="True">
                                                            <DataGridComboBoxColumn.EditingElementStyle>
                                                                <Style TargetType="ComboBox">
                                                                    <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateFromFeatures}" />
                                                                </Style>
                                                            </DataGridComboBoxColumn.EditingElementStyle>
                                                            <DataGridComboBoxColumn.ElementStyle>
                                                                <Style TargetType="ComboBox">
                                                                    <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateFromFeatures}" />
                                                                </Style>
                                                            </DataGridComboBoxColumn.ElementStyle>
                                                        </DataGridComboBoxColumn>
                                                        <DataGridComboBoxColumn  DisplayMemberPath="Name" Header="To Feature" Width="Auto" MinWidth="75" SelectedItemBinding="{Binding ConsolidateToFeature, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CanUserResize="False" IsReadOnly="True">
                                                            <DataGridComboBoxColumn.EditingElementStyle>
                                                                <Style TargetType="ComboBox">
                                                                    <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateToFeatures}" />
                                                                </Style>
                                                            </DataGridComboBoxColumn.EditingElementStyle>
                                                            <DataGridComboBoxColumn.ElementStyle>
                                                                <Style TargetType="ComboBox">
                                                                    <Setter Property="ItemsSource" Value="{Binding Path=ConsolidateToFeatures}" />
                                                                </Style>
                                                            </DataGridComboBoxColumn.ElementStyle>
                                                        </DataGridComboBoxColumn>
                                                        <DataGridTextColumn Binding="{Binding Operation}" Header="Operation" IsReadOnly="True" CanUserResize="False" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Grid>
                                        </Expander>
                                    </Grid>
                                </Grid>
                            </Grid>
                          
                            <Expander Name="expanderDeviceEvents" Header="Events" Grid.Row="7" Grid.ColumnSpan="4"  FontSize="11" Expanded="expanderDeviceEvents_Expanded" Collapsed="expanderDeviceEvents_Collapsed">                            
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <CheckBox Name="checkBoxAutoEvents_Manual" Content="Auto Events" IsChecked="{Binding Path=AutoEvents}" Margin="25,10,10,5" FontSize="10.5"
                                              ToolTip="Check to configure all suitable features as triggers for device events"/>
                                    <DataGrid Name="dataGridDeviceEvents" Grid.Column="1" Grid.Row="0" ItemsSource="{Binding Path=DeviceEvents}" Margin="0,-18,0,30" AutoGenerateColumns="false" 
                                              MinHeight="22" ColumnHeaderHeight="20"  
                                              SelectionMode="Single" Width="350" HorizontalAlignment="Left" FontSize="10" IsReadOnly="{Binding Path=AutoEvents}" 
                                              Grid.RowSpan="2" SelectionChanged="dataGridDeviceEvents_SelectionChanged" 
                                              ToolTip="Details of all device features configured to emit a device event" >
                                        <DataGrid.Columns>
                                            <DataGridComboBoxColumn x:Name="eventFeatureDeviceColumn" Header="Feature" DisplayMemberPath="Name"  Width="Auto" MinWidth="100" 
                                                                    SelectedItemBinding="{Binding EventFeature, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource NullableValueConverter}}"
                                                                    CanUserResize="False" >
                                                <DataGridComboBoxColumn.EditingElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding Path=EventFeatures}" />
                                                    </Style>
                                                </DataGridComboBoxColumn.EditingElementStyle>
                                                <DataGridComboBoxColumn.ElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding Path=EventFeatures}" />
                                                    </Style>
                                                </DataGridComboBoxColumn.ElementStyle>
                                            </DataGridComboBoxColumn>
                                            <DataGridTemplateColumn Header="Event Name"  MinWidth="85" >
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <ComboBox IsEditable="True" 
                                                                  Text="{Binding EventName, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource NullableValueConverter}}" 
                                                                  ItemsSource="{Binding EventNameList}"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridComboBoxColumn x:Name="eventTypeDeviceColumn" Header="Event Type" Width="Auto" MinWidth="100" 
                                                                    SelectedItemBinding="{Binding EventType, Mode=TwoWay, UpdateSourceTrigger=LostFocus, Converter={StaticResource NullableValueConverter}}"
                                                                    CanUserResize="False" >
                                                <DataGridComboBoxColumn.EditingElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding Path=EventTypeList}" />
                                                    </Style>
                                                </DataGridComboBoxColumn.EditingElementStyle>
                                                <DataGridComboBoxColumn.ElementStyle>
                                                    <Style TargetType="ComboBox">
                                                        <Setter Property="ItemsSource" Value="{Binding Path=EventTypeList}" />
                                                    </Style>
                                                </DataGridComboBoxColumn.ElementStyle>
                                            </DataGridComboBoxColumn>
                                            <DataGridCheckBoxColumn Header="Feed-In" Binding="{Binding UseForFeedIn, UpdateSourceTrigger=LostFocus}"  />
                                            
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <Grid Margin="0,0,0,0" Grid.Row="1" Grid.Column="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Button Content="Add" Height="23" HorizontalAlignment="Left" Name="buttonAddDeviceEvent"  ToolTip="Add a new Device Event to the selected Device" Margin="0,0,2,0" Padding="5,0" Click="buttonAddDeviceEvent_Click" FontSize="10" IsEnabled="{Binding Path=ManualEvents}" />
                                        <Button Content="Delete" Height="23"  HorizontalAlignment="Right" Name="buttonDeleteDeviceEvent" Grid.Column="1" ToolTip="Delete the selected Device Event" Margin="4,0,5,0" Padding="5,0" FontSize="10" Click="buttonDeleteDeviceEvent_Click" IsEnabled="False" />
                                    </Grid>
                                </Grid>
                            </Expander>
                            <CheckBox Name="checkBoxAutoEvents_Auto" Content="Auto Events" Grid.Row="7" Grid.Column="1" IsChecked="{Binding Path=AutoEvents}" Margin="0,6,0,0" FontSize="10.5" 
                                      ToolTip="Check to configure all suitable features as triggers for device events" />
                        </Grid>
                    </Grid>

                    <Grid Name="gridDeviceManagerDeviceList" Margin="0,10,10,0" Column="2" Background="#FFDAFFBB" >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="26*" />
                            <RowDefinition Height="43" />
                        </Grid.RowDefinitions>
                        <Label Content="All Devices" Margin="10,0,0,0" FontWeight="Bold" FontSize="13"/>
                        <DataGrid Grid.Row="1" AutoGenerateColumns="False" MinWidth="210" HorizontalAlignment="Stretch" ItemsSource="{Binding AllDevicesList}" x:Name="dataGridDeviceList" VerticalAlignment="Stretch" GridLinesVisibility="Horizontal" ToolTip="Select a Device for detail display. Enable and disable individual Devices." Margin="10,0,10,0" Background="#FFDAFFBB" SelectionChanged="dataGridDeviceList_SelectionChanged" IsSynchronizedWithCurrentItem="True" GotFocus="dataGridDeviceList_GotFocus">

                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Name" MinWidth="140" IsReadOnly="True" Binding="{Binding Name}"/>
                                <DataGridCheckBoxColumn Binding="{Binding Path=Enabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Header="Enabled" >
                                    <DataGridCheckBoxColumn.EditingElementStyle>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="IsEnabled"  Value="{Binding Path=IsRealDevice}" />
                                            <Setter Property="HorizontalAlignment"  Value="Center" />
                                        </Style>
                                    </DataGridCheckBoxColumn.EditingElementStyle>
                                    <DataGridCheckBoxColumn.ElementStyle>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="IsEnabled"  Value="{Binding Path=IsRealDevice}" />
                                            <Setter Property="HorizontalAlignment"  Value="Center" />
                                        </Style>
                                    </DataGridCheckBoxColumn.ElementStyle>
                                </DataGridCheckBoxColumn>
                            </DataGrid.Columns>

                        <DataGrid.Resources>
                                <Style TargetType="DataGridRow">
                                    <Style.Resources>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="Transparent"/>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"/>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Black"/>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.ControlTextBrushKey}" Color="Black"/>                                    
                                    </Style.Resources>
                                    <Style.Triggers>
                                        
                                        <MultiDataTrigger >
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsSelected}" Value="True"/>
                                                <Condition Binding="{Binding Path=DeviceManagerSelected}" Value="True" />
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Background" Value="Yellow"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </MultiDataTrigger>
                                        <MultiDataTrigger >
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsSelected}" Value="False"/>
                                                <Condition Binding="{Binding Path=DeviceManagerSelected}" Value="True" />
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Background" Value="LightYellow"/>
                                        </MultiDataTrigger>
                                        <MultiDataTrigger >
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsSelected}" Value="True"/>
                                                <Condition Binding="{Binding Path=DeviceManagerSelected}" Value="False" />
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Background" Value="LightCyan"/>
                                        </MultiDataTrigger>
                                        <MultiDataTrigger >
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=IsSelected}" Value="False"/>
                                                <Condition Binding="{Binding Path=DeviceManagerSelected}" Value="False" />
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="Background" Value="LightCyan"/>
                                        </MultiDataTrigger>

                                    </Style.Triggers>
                                </Style>
                            </DataGrid.Resources>
                            
                            
                            
                        </DataGrid>
                        <Grid Margin="0,10,0,0"  Grid.Row="2">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Button Content="Add Device" Height="23" HorizontalAlignment="Left" Name="buttonAddDevice" VerticalAlignment="Top" ToolTip="Add a new Device to the selected Device Manager" Margin="10,0,2,0" Padding="2,1" Click="buttonAddDevice_Click" />
                            <Button Content="Delete Device" Height="23" HorizontalAlignment="Right" Name="buttonDeleteDevice" VerticalAlignment="Top" Grid.Column="1" ToolTip="Delete the selected Device" Margin="2,0,10,0" Padding="2,1" IsEnabled="False" Click="buttonDeleteDevice_Click" />
                        </Grid>
                    </Grid>


                </Grid>
            </TabItem>
            <TabItem Header="pvoutput.org Settings" Name="tabItem6" ToolTip="Configure pvoutput.org communication settings" Padding="6,3">
                <Grid>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid HorizontalAlignment="Left">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="41*" />
                                <RowDefinition Height="32" />
                            </Grid.RowDefinitions>
                            <DataGrid AutoGenerateColumns="False" DataContext="{Binding}" ItemsSource="{Binding PvOutputSystemList}" HorizontalAlignment="Stretch" Margin="10,10,10,10" Name="dataGridPvOutputSiteIds" VerticalAlignment="Stretch" Width="185" SelectionChanged="dataGridPvOutputSiteList_SelectionChanged" SelectedIndex="0" ToolTip="Lists all defined pvoutput Sites">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="System Name" Binding="{Binding Path=Name, Mode=TwoWay}" CanUserReorder="False" MinWidth="100" IsReadOnly="True"  />
                                    <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enable}" CanUserReorder="False" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Grid Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Stretch">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Button Content="Add System" Name="buttonAddSite" VerticalAlignment="Top" Click="buttonAddSite_Click" ToolTip="Add another pvoutput site" Padding="4,1" Margin="10,0,0,10" />
                                <Button Content="Delete System" HorizontalAlignment="Right" Name="buttonDeleteSite" Click="buttonDeleteSite_Click" ToolTip="Delete selected pvoutput site" Grid.Column="1" Padding="4,1" HorizontalContentAlignment="Center" Margin="0,0,10,10" VerticalAlignment="Center" />
                            </Grid>
                        </Grid>

                        <Grid Name="gridPvOutputSite" VerticalAlignment="Stretch" Grid.Column="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="130*" />
                                </Grid.ColumnDefinitions>
                            
                            
                                <Label Content="System Name" HorizontalContentAlignment="Right" HorizontalAlignment="Right" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,10,0,0" />
                                <TextBox Text="{Binding Path=Name, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Enter the 'Name' of the inverter" Grid.Column="1" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,10,0,0" />

                                <Label Content="System ID" Height="28" HorizontalContentAlignment="Right" Name="label23" Grid.Row="1" VerticalAlignment="Center" VerticalContentAlignment="Center" />
                                <TextBox Text="{Binding Path=SystemId, Converter={StaticResource NullableValueConverter}}" ToolTip="The pvoutput.org Site Id - register with pvoutput.org to obtain this" Grid.Column="1" Grid.Row="1" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5" />
                                <StackPanel Grid.Column="2" Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Label Content="API Version" VerticalAlignment="Center" VerticalContentAlignment="Center" />
                                    <ComboBox IsEditable="True" Text="{Binding Path=APIVersion, Converter={StaticResource NullableValueConverter}}" ToolTip="pvoutput API version. Defaults to latest known at time of PVBC publication." MinWidth="50" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5">
                                        <ComboBoxItem Content="" />
                                        <ComboBoxItem Content="r1" />
                                        <ComboBoxItem Content="r2" />
                                    </ComboBox>
                                </StackPanel>

                                <Label Content="API Key" Height="28" HorizontalContentAlignment="Right" Grid.Row="2" VerticalAlignment="Center" VerticalContentAlignment="Center" />
                                <TextBox Text="{Binding Path=APIKey, Converter={StaticResource NullableValueConverter}}" ToolTip="pvoutput.org API Key - register with pvoutput.org to obtain this" Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5" />

                                <Label Content="Status Interval" Height="28" HorizontalContentAlignment="Right" Grid.Row="3" VerticalAlignment="Center" VerticalContentAlignment="Center" />
                                <ComboBox Name="comboBox4" Text="{Binding Path=DataInterval, Converter={StaticResource NullableValueConverter}}" ToolTip="Must match the &quot;Status Interval&quot; setting at pvoutput.org (default is 10)" Grid.Column="1" Grid.Row="3" VerticalAlignment="Center" VerticalContentAlignment="Center" HorizontalAlignment="Left" MinWidth="40" Margin="0,5">
                                    <ComboBoxItem Content="5" />
                                    <ComboBoxItem Content="10" />
                                </ComboBox>
                                <CheckBox Content="Upload Yield" IsChecked="{Binding Path=UploadYield, Converter={StaticResource NullableValueConverter}}" Name="checkBoxUploadYield" ToolTip="Upload inverter yield to pvoutput" Grid.Column="2" Grid.Row="3" VerticalAlignment="Center" VerticalContentAlignment="Center" />


                                <CheckBox Content="Upload Consumption" IsChecked="{Binding Path=UploadConsumption, Converter={StaticResource NullableValueConverter}}" ToolTip="Update consumption to pvoutput" Grid.Column="2" Grid.Row="4" VerticalAlignment="Center" VerticalContentAlignment="Center" />
                                <Label Content="Live Upload Days" HorizontalContentAlignment="Right" Grid.Row="5" VerticalAlignment="Center" VerticalContentAlignment="Center" />

                                <ComboBox Text="{Binding Path=LiveDays, Converter={StaticResource NullableValueConverter}}" Name="comboBoxLiveDays"
                                          ToolTip="Number of days to monitor for pvoutput upload - 1 for today only" 
                                          Grid.Row="5" Grid.Column="1" HorizontalAlignment="Left" MinWidth="40" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5" />

                                <CheckBox Content="Have PVOutput Subscription" IsChecked="{Binding Path=HaveSubscription, NotifyOnSourceUpdated=True}" Name="checkBoxHaveSubscription"
                                          ToolTip="I Have a PVOutput Subscription" Grid.Column="2" Grid.Row="5" VerticalAlignment="Center" VerticalContentAlignment="Center" SourceUpdated="checkBoxHaveSubscription_SourceUpdated" />

                                <CheckBox Content="Enable Upload" IsChecked="{Binding Path=Enable, Converter={StaticResource NullableValueConverter}}" 
                                          ToolTip="Turns pvoutput.org on or off" Grid.Column="1" Grid.Row="6" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5" />
                                <CheckBox Content="Enable Auto Backload" 
                                          IsChecked="{Binding Path=AutoBackload, Converter={StaticResource NullableValueConverter}}" 
                                          ToolTip="Auto upload daily totals for missing days at pvoutput.org beyond live upload limit" 
                                          Grid.Column="1" Grid.Row="7" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5" />
                                
                                <CheckBox Content="Power Alternates Min / Max" 
                                          IsChecked="{Binding Path=PowerMinMax, Converter={StaticResource NullableValueConverter}}" 
                                          ToolTip="Alternately display minimum and maximum interval power " 
                                          Grid.Column="1" Grid.Row="8" Grid.ColumnSpan="2" VerticalAlignment="Center" VerticalContentAlignment="Center" Margin="0,5" />
                            </Grid>
                            <Grid Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="201" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="34" />
                                    <RowDefinition Height="294*" />
                                </Grid.RowDefinitions>
                                <Label Content="PVOutput Update Days" Name="label45" VerticalAlignment="Top" Margin="10,8,10,0" />
                                <DataGrid AutoGenerateColumns="False" DataContext="{Binding NotifyOnSourceUpdated=True, NotifyOnTargetUpdated=True, Mode=OneWay}" Name="dataGridPVOutputDays" MinWidth="181" ItemsSource="{Binding PvOutputDayList}" ToolTip="Lists the days that will be uploaded to pvoutput.org" VerticalContentAlignment="Stretch" Grid.Row="1" Margin="10,0,10,10" HorizontalContentAlignment="Stretch">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Day" Binding="{Binding Day, StringFormat={}{0:dd/MM/yyyy}}" MinWidth="100" IsReadOnly="True" />
                                        <DataGridCheckBoxColumn Header="Force" Binding="{Binding ForceLoad}" CanUserReorder="True" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Header="Suspend Control" Name="tabItem2" IsEnabled="True" Padding="6,3" ToolTip="Control automatic suspend / resume and inverter access time interval" >
                <Canvas Height="328" VerticalAlignment="Top">
                    <Border BorderBrush="Silver" BorderThickness="1" Canvas.Left="10" Canvas.Top="12" Height="153" Name="border2" Opacity="0.5" Width="371">
                    </Border>
                    <Border BorderBrush="Silver" BorderThickness="1" Canvas.Left="387" Canvas.Top="12" Height="153" Name="border1" Width="350" Opacity="0.5" />
                    <ComboBox Canvas.Left="529" Canvas.Top="132" IsEditable="False" Name="comboBox2" Text="{Binding Path=ServiceSuspendType, Converter={StaticResource NullableValueConverter}}" Width="81" Height="23" ToolTip="The type of suspension used - Sleep or Hibernate">
                        <ComboBoxItem Content="sleep" />
                        <ComboBoxItem Content="hibernate" />
                        <ComboBoxItem Content="idle" />
                    </ComboBox>
                    <cgs:TimeControl Name="timeControlServiceStart" Canvas.Left="155" Canvas.Top="45" Value="{Binding Path=ServiceStartTime, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Start time - The computer will be suspended until this time" />                    
                    <Label Canvas.Left="15" Canvas.Top="43" Content="Evening Suspend - Start" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label16" />
                    <cgs:TimeControl Name="timeControlServiceStop" Canvas.Left="276" Canvas.Top="45" Value="{Binding Path=ServiceStopTime, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Stop time - The computer will be suspended after this time" />
                    <Label Canvas.Left="233" Canvas.Top="43" Content="Stop" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label17" Width="37" />
                    <cgs:TimeControl Name="timeControlWakeInterval" Canvas.Left="529" Canvas.Top="74" Value="{Binding Path=ServiceWakeInterval, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Computer will execute for this period of time and will then be suspended"  />
                    <Label Canvas.Left="432" Canvas.Top="72" Content="Wake Interval" HorizontalContentAlignment="Right" IsEnabled="True" Name="label18" Width="91" />
                    <cgs:TimeControl Name="timeControlSuspendInterval" Canvas.Left="529" Canvas.Top="103" Value="{Binding Path=ServiceSuspendInterval, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="During normal operating period the computer will be activated after this time period"  />
                    <Label Canvas.Left="424" Canvas.Top="101" Content="Suspend Interval" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label19" Width="99" />
                    <Label Canvas.Left="379" Canvas.Top="127" Content="Suspend Type" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label20" Width="144" />
                    <CheckBox Canvas.Left="529" Canvas.Top="23" Content="Enable Interval Suspend" Height="16" Name="checkBox3" IsChecked="{Binding Path=EnableIntervalSuspend, Converter={StaticResource NullableValueConverter}}" ToolTip="Turns suspend control on or off " />
                    <CheckBox Canvas.Left="155" Canvas.Top="24" Content="Enable Evening Suspend" Height="16" Name="checkBox10" IsEnabled="True" IsChecked="{Binding Path=EnableEveningSuspend, Converter={StaticResource NullableValueConverter}}" ToolTip="Auto suspend computer before Start Time and after Stop Time" />
                    <ComboBox Canvas.Left="155" Canvas.Top="74" Height="23" Name="comboBox3" Width="81" Text="{Binding Path=EveningSuspendType, Converter={StaticResource NullableValueConverter}}">
                        <ComboBoxItem Content="sleep" />
                        <ComboBoxItem Content="hibernate" />
                        <ComboBoxItem Content="idle" />
                    </ComboBox>
                    
                    <Label Canvas.Left="15" Canvas.Top="69" Content="Suspend Type" Height="28" Name="label27" Width="134" HorizontalAlignment="Stretch" HorizontalContentAlignment="Right" />
                    <cgs:TimeControl Name="timeControlIntervalStart" Canvas.Left="529" Canvas.Top="45" Value="{Binding Path=IntervalStartTime, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Interval Suspend / Resume will start after this time" />
                    <Label Canvas.Left="390" Canvas.Top="43" Content="Interval Suspend - Start" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label29" />
                    <cgs:TimeControl Name="timeControlIntervalStop" Canvas.Left="648" Canvas.Top="45" Value="{Binding Path=IntervalStopTime, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Interval Suspend / Resume will stop after this time. Interval Stop Time must be greater than Interval Start Time" />
                    <Label Canvas.Left="605" Canvas.Top="43" Content="Stop" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label30" Width="37" />
                    
                    <Border BorderBrush="Silver" BorderThickness="1" Canvas.Left="10" Canvas.Top="171" Height="108" Name="border3" Opacity="0.5" Width="371" />
                    <Border BorderBrush="Silver" BorderThickness="1" Canvas.Left="10" Canvas.Top="285" Height="37" Name="border3a" Opacity="0.5" Width="371" />

                    <cgs:TimeControl Name="timeControlInverterStart" Canvas.Left="157" Canvas.Top="192" Value="{Binding Path=InverterStartTime, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Inverter monitor start time - Use to prevent PVBC accessing inverter in the evening" />
                    <cgs:TimeControl Name="timeControlInverterStop" Canvas.Left="157" Canvas.Top="221" Value="{Binding Path=InverterStopTime, Mode=TwoWay, Converter={StaticResource NullableValueConverter}}" ToolTip="Inverter monitor stop time - Use to prevent PVBC accessing inverter in the evening" />
                    <Label Canvas.Left="60" Canvas.Top="190" Content="Inverter Start" Height="28" Name="label33" HorizontalContentAlignment="Right" Width="89" />
                    <Label Canvas.Left="51" Canvas.Top="219" Content="Inverter Stop" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label21" Width="98" />
                    <CheckBox Content="Auto Resume from Manual Suspend" Height="16" Name="checkBox9" IsEnabled="True" IsChecked="{Binding Path=ManualSuspendAutoResume, Converter={StaticResource NullableValueConverter}}" ToolTip="Auto resume after an external suspend event (useful when other software suspends computer) " Canvas.Left="157" Canvas.Top="250" />
                    <Border BorderBrush="Silver" BorderThickness="1" Canvas.Left="387" Canvas.Top="171" Height="108" Name="border4" Opacity="0.5" Width="350" />
                    <CheckBox Canvas.Left="459" Canvas.Top="190" Content="CC History Suspend / Resume Control" Height="16" IsChecked="{Binding Path=MeterHistoryTimeLineAdjust}" ToolTip="Adjust Suspend / Resume timeline to ensure CC History is captured" />
                    <TextBox Canvas.Left="459" Canvas.Top="243" Height="23" Name="textBox16" Text="{Binding Path=MeterHistoryStartMinute, Converter={StaticResource NullableValueConverter}}" ToolTip="Start minute in the hour at which history records will be received (blank / default is safe)" Width="56" />
                    <TextBox Canvas.Left="543" Canvas.Top="243" Height="23" Name="textBox17" Text="{Binding Path=MeterHistoryEndMinute, Converter={StaticResource NullableValueConverter}}" ToolTip="Minute in hour when history records will be complete (blank / default is safe)" Width="56" />
                    <Label Canvas.Left="400" Canvas.Top="212" Content="History Start Minute" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label37" Width="123" />
                    <Label Canvas.Left="529" Canvas.Top="212" Content="End Minute" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label38" Width="76" />
                    <Label Canvas.Left="70" Canvas.Top="290" Content="Wake Delay" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Name="label47" />
                    <ComboBox Canvas.Left="155" Canvas.Top="293" Height="23" Name="comboBox1" Width="74" Text="{Binding Path=WakeDelay, Converter={StaticResource NullableValueConverter}}" ToolTip="Delay after wake from suspend (seconds)">
                        <ComboBoxItem Content="0" />
                        <ComboBoxItem Content="30" />
                        <ComboBoxItem Content="60" />
                        <ComboBoxItem Content="90" />
                        <ComboBoxItem Content="120" />
                        <ComboBoxItem Content="150" />
                        <ComboBoxItem Content="180" />
                        <ComboBoxItem Content="210" />
                        <ComboBoxItem Content="240" />
                        <ComboBoxItem Content="270" />
                        <ComboBoxItem Content="300" />
                    </ComboBox>
                </Canvas>
            </TabItem>
            <TabItem Header="Database" Name="tabItem1" Padding="6,3" ToolTip="Database configuration settings">
                <Canvas Height="327" Width="834" VerticalAlignment="Top">
                    <TextBox Height="23" Name="txtHost" Width="174" Text="{Binding Path=Host, Converter={StaticResource NullableValueConverter}}" Canvas.Left="171" Canvas.Top="25" ToolTip="Database machine name or IP Address" />
                    <Label Content="Host" Height="28" IsEnabled="True" Name="label3" HorizontalContentAlignment="Right" Canvas.Left="131" Canvas.Top="23" />
                    <ComboBox Height="23" Name="cbxDatabaseType" Width="174" Text="{Binding Path=DatabaseType, Converter={StaticResource NullableValueConverter}}" IsEditable="True" Canvas.Left="171" Canvas.Top="54" ToolTip="Database Type">
                        <ComboBoxItem Content="Jet" />
                        <ComboBoxItem Content="MySql" />
                        <ComboBoxItem Content="SQLite" />
                        <ComboBoxItem Content="SQL Server" />
                    </ComboBox>
                    <Label Content="Database Type" Height="28" Name="label1" IsEnabled="True" HorizontalContentAlignment="Right" Canvas.Left="82" Canvas.Top="52" />
                    <ComboBox Height="23" Name="cbxProviderType" Width="174" Text="{Binding Path=ProviderType, Converter={StaticResource NullableValueConverter}}" IsEditable="True" Canvas.Left="171" Canvas.Top="84" ToolTip="Proprietary for database specific provider - OleDb for generic database access via OleDb">
                        <ComboBoxItem Content="OleDb" />
                        <ComboBoxItem Content="Proprietary" />
                    </ComboBox>
                    <Label Content="Provider Type" Height="28" IsEnabled="True" Name="label2"  HorizontalContentAlignment="Right" Canvas.Left="83" Canvas.Top="82" />
                    <ComboBox Height="23" Name="cbxOleDbProvider" Width="174" Text="{Binding Path=OleDbName, Converter={StaticResource NullableValueConverter}}" IsEditable="True" Canvas.Left="171" Canvas.Top="142" ToolTip="Only used when Provider Name is System.Data.OleDb">
                        <ComboBoxItem Content="Microsoft.ACE.OLEDB.12.0" />
                        <ComboBoxItem Content="Microsoft.Jet.OLEDB.4.0" />
                    </ComboBox>
                    <Label Content="OleDb Name" Height="28" IsEnabled="True" Name="label7" HorizontalContentAlignment="Right" Canvas.Left="91" Canvas.Top="140" />
                    <ComboBox Height="23" Name="cbxProvider" Width="174" Text="{Binding Path=ProviderName, Converter={StaticResource NullableValueConverter}}" IsEditable="True" Canvas.Left="171" Canvas.Top="113" ToolTip="Registered name of the .Net provider">
                        <ComboBoxItem Content="MySql.Data.MySQLClient" />
                        <ComboBoxItem Content="System.Data.OleDb" />
                        <ComboBoxItem Content="System.Data.SQLite" />
                        <ComboBoxItem Content="System.Data.SqlClient" />
                    </ComboBox>
                    <Label Content="Provider Name" Height="28" IsEnabled="True" Name="label8" HorizontalContentAlignment="Right" Canvas.Left="81" Canvas.Top="111" />
                    <TextBox Height="23" Name="txtUserName" Width="154" Text="{Binding Path=UserName, Converter={StaticResource NullableValueConverter}}" Canvas.Left="517" Canvas.Top="25" ToolTip="Used when the database requires a login username" />
                    <Label Content="User Name" Height="28" IsEnabled="True" Name="label4" HorizontalContentAlignment="Right" Canvas.Left="447" Canvas.Top="21" />
                    <TextBox Height="23" Name="txtPassword" Width="154" Text="{Binding Path=Password, Converter={StaticResource NullableValueConverter}}" Canvas.Left="517" Canvas.Top="54" ToolTip="Used when the database requires a login password" />
                    <Label Content="Password" Height="28" IsEnabled="True" Name="label5" HorizontalContentAlignment="Right" Canvas.Left="456" Canvas.Top="52" />
                    <TextBox Height="23" Name="txtDatabase" Text="{Binding Path=Database, Converter={StaticResource NullableValueConverter}}" Canvas.Left="517" Canvas.Top="84" Width="200" ToolTip="The database &quot;Schema&quot; name (MySql) or database file name (Jet)" />
                    <Label Content="Database / Data Source" DataContext="{Binding}" Height="28" IsEnabled="True" Name="label6"  HorizontalContentAlignment="Right" Canvas.Left="381" Canvas.Top="82" />
                    <TextBox Height="23" Name="txtConnectionString" Text="{Binding Path=ConnectionString, Converter={StaticResource NullableValueConverter}}" Width="612" Canvas.Left="171" Canvas.Top="240" ToolTip="Normally blank - if used it overrides connection string generation from the information entered above" />
                    <Label Content="Connection String" DataContext="{Binding}" Height="28" IsEnabled="True" Name="label10" HorizontalContentAlignment="Right" Canvas.Left="60" Canvas.Top="238" />
                </Canvas>
            </TabItem>
            <TabItem Header="Log Files" ToolTip="Log file content control" Padding="6,3">
                <Grid Margin="20,20,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="1" Margin="5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <CheckBox Grid.Column="0" Content="Trace" Height="16" IsChecked="{Binding Path=LogTrace, Converter={StaticResource NullableValueConverter}}" IsEnabled="True" Margin="0,5,5,5" ToolTip="Log trace messages - This can produce a large log file - use with caution" />
                        <CheckBox Grid.Column="0" Grid.Row="1" Content="Meter Trace" Height="16" IsChecked="{Binding Path=LogMeterTrace, Converter={StaticResource NullableValueConverter}}" Margin="0,5,5,5" Name="checkBox13" ToolTip="Log power meter trace messages. This can produce a large log file very quickly." />
                        <CheckBox Grid.Column="0" Grid.Row="2" Content="Message Content" Height="16" IsChecked="{Binding Path=LogMessageContent, Converter={StaticResource NullableValueConverter}}" Margin="0,5,5,5" Name="checkBox7" ToolTip="Log all message content - produces a very large log file" />
                        <CheckBox Grid.Column="1" Content="DB Trace" DataContext="{Binding}" Height="16" IsChecked="{Binding Path=LogDatabase, Converter={StaticResource NullableValueConverter}}" Margin="10,5,5,5" Name="checkBox4" ToolTip="Log database commands" />
                        <CheckBox Grid.Column="1" Grid.Row="1" Content="Event" Height="16" IsChecked="{Binding Path=LogEvent, Converter={StaticResource NullableValueConverter}}" IsEnabled="True" Margin="10,5,5,5" Name="checkBox12" ToolTip="Log energy event management activities - This can produce a large log file - use with caution" VerticalAlignment="Top" />
                        <CheckBox Grid.Column="2" Content="Information" Height="16" IsChecked="{Binding Path=LogInformation, Converter={StaticResource NullableValueConverter}}" Margin="10,5,5,5" Name="checkBox5" ToolTip="Log information entries" IsEnabled="False" />
                        <CheckBox Grid.Column="2" Grid.Row="1" Content="Status" DataContext="{Binding}" Height="16" IsChecked="{Binding Path=LogStatus, Converter={StaticResource NullableValueConverter}}" Margin="10,5,5,5" Name="checkBox6" ToolTip="Log status changes" IsEnabled="False" />
                    </Grid>
                    
                    <Label Grid.Row="1" Content="Log File Name" DataContext="{Binding}" Height="28" HorizontalContentAlignment="Right" IsEnabled="True" Margin="5" Name="label9" />
                    <TextBox Grid.Column="1" Grid.Row="1" MinWidth="500" Height="23" Margin="5" Text="{Binding Path=LogFile, Mode=OneWay, Converter={StaticResource NullableValueConverter}}" IsReadOnly="True" />
                    <CheckBox Grid.Column="1" Grid.Row="2" Content="New Log File Each Day" Margin="5,5,15,5" IsChecked="{Binding Path=NewLogEachDay, Converter={StaticResource NullableValueConverter}}" ToolTip="Check to create a new log file every day" />
                    <Label Grid.Column="0" Grid.Row="3" Content="Log Retain Days" Margin="5,5,5,5"  VerticalAlignment="Center" HorizontalAlignment="Right" />
                    <ComboBox Grid.Column="1" Grid.Row="3" Height="23" Margin="5,5,15,5"  Text="{Binding Path=LogRetainDays, Converter={StaticResource NullableValueConverter}}" ToolTip="Number of days old log files are retained (empty = indefinite retention)" Width="56" HorizontalAlignment="Left" IsEditable="True">
                        <ComboBoxItem Content="1" />
                        <ComboBoxItem Content="2" />
                        <ComboBoxItem Content="3" />
                        <ComboBoxItem Content="4" />
                        <ComboBoxItem Content="5" />
                        <ComboBoxItem Content="6" />
                        <ComboBoxItem Content="7" />
                        <ComboBoxItem Content="14" />
                        <ComboBoxItem Content="28" />
                        <ComboBoxItem Content="31" />
                        <ComboBoxItem Content="62" />
                        <ComboBoxItem Content="92" />
                        <ComboBoxItem Content="183" />
                        <ComboBoxItem Content="365" />
                        <ComboBoxItem Content="" />
                    </ComboBox>
                    <Label Content="Inverter Logs"  Grid.Row="4" HorizontalContentAlignment="Right" Margin="5,5,5,5"  />
                    <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal">
                        <TextBox Name="textBoxInverterLogs" MinWidth="500" Height="23" Margin="5" Text="{Binding Path=InverterLogs, Converter={StaticResource NullableValueConverter}}" ToolTip="Override location for inverter error logs, default is &quot;ErrorLogs&quot; in default directory" />
                        <Button Content="..." Height="23" Name="butInverterLogs" Width="26" HorizontalAlignment="Right" VerticalAlignment="Center" Click="butInverterLogs_Click" ToolTip="Locate inverter error logs directory" />
                    </StackPanel>
                    <StackPanel  Grid.Column="1" Grid.Row="5" Orientation="Horizontal">
                        <Button Content="Default Log Settings" Height="23" HorizontalAlignment="Left" Margin="5,15,0,5" Name="butDefaultLogSettings" Click="butDefaultLogSettings_Click" VerticalAlignment="Top" Width="138" ToolTip="Return to default log file settings" />
                        <Button Content="Release Error Loggers" Height="23" HorizontalAlignment="Left" Margin="250,15,0,5" Name="butReleaseErrorLoggers" Click="butReleaseErrorLoggers_Click" VerticalAlignment="Top" Width="138" ToolTip="Finalise and close all open Error Loggers" />
                    </StackPanel>
                </Grid>
            </TabItem>
            <TabItem Header="Device List" Name="tabItem8" ToolTip="Lists all detected Devices" Padding="6,3" >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="36*" />
                        <RowDefinition Height="46" />
                    </Grid.RowDefinitions>
                    <DataGrid AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False" DataContext="{Binding}" 
                              HorizontalAlignment="Stretch" Margin="10,10,10,0" Name="dataGridInverterList" SelectionMode="Single" VerticalAlignment="Stretch" 
                              ToolTip="Lists the Device Features currently recorded in the PV Bean Counter database. No configuration required here">
                        <DataGrid.Columns>
                            <DataGridTextColumn Binding="{Binding Path=Id}" Header="Id" IsReadOnly="True" MinWidth="20" />
                            <DataGridTextColumn Binding="{Binding Path=DeviceType}" Header="Device Type" IsReadOnly="True" MinWidth="180" />
                            <DataGridTextColumn Binding="{Binding Path=SerialNumber}" Header="Serial No" IsReadOnly="True" MinWidth="120" />
                            <DataGridTextColumn Binding="{Binding Path=Manufacturer}" Header="Manufacturer" IsReadOnly="True" MinWidth="150" />
                            <DataGridTextColumn Binding="{Binding Path=Model}" Header="Model" IsReadOnly="True" MinWidth="150" />
                            <DataGridTextColumn Binding="{Binding Path=FeatureType}" Header="Feature Type" IsReadOnly="True" MinWidth="180" />
                            <DataGridTextColumn Binding="{Binding Path=FeatureId}" Header="Feature Id" IsReadOnly="True" MinWidth="20" />
                        </DataGrid.Columns>
                    </DataGrid>
                    <Button Content="Retrieve / Refresh" Height="23" HorizontalAlignment="Left" Margin="10,10,0,0" Name="buttonInverterRefresh" VerticalAlignment="Top" Width="119" Click="buttonInverterRefresh_Click" ToolTip="Retrieve or Refresh the Inverter List" Grid.Row="1" />
                </Grid>
            </TabItem>

        </TabControl>
        
        <StackPanel HorizontalAlignment="Left" Margin="70,4,10,4" Name="stackPanel1" VerticalAlignment="Top" Canvas.Top="35" Orientation="Horizontal" Grid.Row="1">
            <Label Content="Version" Name="label25" HorizontalContentAlignment="Right" IsEnabled="False" />
            <TextBox Height="23" Name="textBox9" MinWidth="60"  Text="{Binding Path=ApplicationVersion, Mode=OneTime}" IsEnabled="False" IsReadOnly="True" FontFamily="Courier New" IsTabStop="False" IsHitTestVisible="False" IsUndoEnabled="False" Padding="4" />
            <Label  Content="Service Status" Height="28" HorizontalContentAlignment="Right" IsEnabled="False" Name="label11" Margin="65,0,0,0" />
            <TextBox Height="23" Name="txtServiceStatus" Width="140" IsEnabled="False"  />               
            <Button Content="Start Service" Height="26" Name="butStartService" Width="97" Click="butStartService_Click" IsEnabled="False" ToolTip="Starts the windows service using the current saved parameters" Margin="70,0,0,0" />
            <Button Content="Stop Service" Height="26" Name="butStopService" Width="87" Click="butStopService_Click" IsEnabled="False" ToolTip="Stops the windows service" Margin="10,0,0,0" />
            <Button Content="Save Settings" Height="26" Name="butSavePVSettings" Width="91" Click="butSavePVSettings_Click" IsDefault="True" IsEnabled="False" ToolTip="Saves the parameter changes - The service must be restarted for changes to be effective" HorizontalAlignment="Stretch" Margin="50,0,0,0" />
        </StackPanel>
    </Grid>
</Window>
